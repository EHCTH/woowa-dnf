## 채팅 기능

### 구현 목적
- 기존 사이트들과 차별점을 두고 싶어서, 캐릭터별 **실시간 채팅 기능**을 한 번 넣어 보고자 했습니다.
- 익명 게시판 특성상 특정 유저를 대상으로 한 공격이나 **마녀사냥** 등이 발생할 수 있다고 판단하여,  
  우선은 **운영자 전용 삭제 API**만 제공하고 있습니다.
  누구에게 삭제 권한을 줄지 정책을 아직 정하지 못해, 초기 단계에서는 운영자만 삭제 가능하도록 두었습니다.(추후에 삭제 요청 버튼을 누르면 운영자한테 로그가 남도록 구현 할 예정입니다)

### 채팅 기능
- 캐릭터 상세 페이지 우측 탭에 **실시간 채팅**을 제공합니다.
- 각 채팅방은 `{서버 ID}:{캐릭터 ID}` 조합으로 구분됩니다.
- Spring WebSocket을 사용하여 브라우저와 서버가 실시간으로 메시지를 주고받습니다.
- **로컬 환경**에서는 메모리 기반 휘발성 저장소를 사용하고  
  **운영 환경**에서는 EC2 위의 MySQL 컨테이너를 통해 채팅 메시지를 영속화합니다.

### 동작 방식
채팅 메시지를 저장/조회하는 흐름은 다음과 같습니다.
``` 
[저장]
Client DTO(요청)
-> Domain(ChatMessage)
-> 저장(MySQL / 메모리)

[조회]
조회(MySQL / 메모리)
-> Domain(ChatMessage)
-> View DTO(응답)
```

### 로컬 토큰
```
CHAT_ADMIN_TOKEN=local-token # 실제 운영용 토큰은 따로 ec2 안에 작성하였습니다
```

### 운영자 전용 삭제 API
```
curl -X DELETE \
  -H "X-CHAT_ADMIN-TOKEN: ${CHAT_ADMIN_TOKEN}" \
  "http://localhost:8080/internal/admin/chat/rooms/{serverId}/{characterId}"
```
위 명령어를 실행하게되면 해당 채팅방 내역을 삭제 할 수 있습니다.
